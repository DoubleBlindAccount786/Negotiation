<!doctype html>
 <html>
 <head>
 <meta charset="utf-8">
 <title>c(ASP) Justification</title>
 <style>
.treemenu li { list-style: none; }
.treemenu .toggler { cursor: pointer; }
.treemenu .toggler:before { display: inline-block; margin-right: 2pt; }
li.tree-empty > .toggler { opacity: 0.3; cursor: default; }
li.tree-empty > .toggler:before { content: " "; }
li.tree-closed > .toggler:before {
    content: "";
    height: 0;
    width: 0;
    border-color: transparent blue;
    border-style: solid;
    border-width: 0.25em 0 0.25em 0.5em;
}
li.tree-opened > .toggler:before {
    content: "";
    height: 0;
    width: 0;
    border-color: blue transparent ;
    border-style: solid;
    border-width: 0.5em 0.25em 0 0.25em;
}
</style>
 
 <link rel="icon" href="logo.ico">
 
 </head>
 
 <body style="font-size:15px;background: #ECECEC; margin:80px; color:#333;">
 
<h3>Query:</h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?-&nbsp;&nbsp;query(Product,Maker,Price).<br>
<br>
<h3>Answer:</h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Product = a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maker = c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Price = low<br>
<br>

<h3>Model:</h3>
{ query(a,c,low),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buy(a,c,low),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accept_price(a,c,low),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maker(a,c),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product(a),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product_a,  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(product(a)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(maker(a,c)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product(b),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;product_b,  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(product(b)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(-maker(b,c)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(-maker(a,d)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maker(b,d),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(maker(b,d)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail_list,  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(mail_list),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cash,  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(cash),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;senior_customer,  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;age_older_than_65,  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(age_older_than_65),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quality(a),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evidence(quality(a)),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sale(a,c,low),  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offer_price_a(a,c,low) }<br><br>
<h3> Justification: <button onclick="expand()">Expand All</button><button onclick="depth(+1)">+1</button><button onclick="depth(-1)">-1</button><button onclick="collapse()">Collapse All</button></h3>


 <ul class="tree">


     <li> 
     query(a,c,low) :-
         <ul>
         <li> 
         buy(a,c,low) :-
             <ul>
             <li> 
             accept_price(a,c,low) :-
                 <ul>
                 <li> 
                 accept_price_3(a,c,low) :-
                     <ul>
                     <li> 
                     maker(a,c) :-
                         <ul>
                         <li> 
                         product(a) :-
                             <ul>
                             <li> 
                             product_a :-
                                 <ul>
                                 <li> 
                                 evidence(product(a)).
                                 </li> 
                                 </ul> 
                             </li> 
                             </ul> 
                         </li> 
                         <li> 
                         evidence(maker(a,c)).
                         </li> 
                         </ul> 
                     </li> 
                     </ul> 
                 </li> 
                 <li> 
                 not accept_price_1_check :-
                     <ul>
                     <li> 
                     not accept_price_1(Var3 | {Var3 \= a,Var3 \= b},Var4 | {Var4 \= c},Var5),
                     </li> 
                     <li> 
                     not accept_price_1(Var3 | {Var3 \= a,Var3 \= b},c,Var6) :-
                         <ul>
                         <li> 
                         not maker(Var3 | {Var3 \= a,Var3 \= b},c) :-
                             <ul>
                             <li> 
                             not product(Var3 | {Var3 \= a,Var3 \= b}),
                             </li> 
                             <li> 
                             not product(Var3 | {Var3 \= a,Var3 \= b}).
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     not accept_price_1(a,Var7 | {Var7 \= c},Var8),
                     </li> 
                     <li> 
                     not accept_price_1(a,c,Var9 | {Var9 \= lowest}) :-
                         <ul>
                         <li> 
                         proved(maker(a,c)).
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     accept_price_1(a,c,lowest) :-
                         <ul>
                         <li> 
                         proved(maker(a,c)).
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     not sale(a,c,lowest) :-
                         <ul>
                         <li> 
                         not offer_price_a(a,c,lowest) :-
                             <ul>
                             <li> 
                             not offer_price_1(a,c,lowest),
                             </li> 
                             <li> 
                             not offer_price_2(a,c,lowest),
                             </li> 
                             <li> 
                             not offer_price_3(a,c,lowest),
                             </li> 
                             <li> 
                             not offer_price_4(a,c,lowest).
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     not accept_price_1(b,Var10 | {Var10 \= c},Var11),
                     </li> 
                     <li> 
                     not accept_price_1(b,c,Var12) :-
                         <ul>
                         <li> 
                         not maker(b,c) :-
                             <ul>
                             <li> 
                             product(b) :-
                                 <ul>
                                 <li> 
                                 product_b :-
                                     <ul>
                                     <li> 
                                     evidence(product(b)).
                                     </li> 
                                     </ul> 
                                 </li> 
                                 </ul> 
                             </li> 
                             <li> 
                             not evidence(maker(b,c)),
                             </li> 
                             <li> 
                             proved(product(b)),
                             </li> 
                             <li> 
                             proved(not evidence(maker(b,c))),
                             </li> 
                             <li> 
                             neg_maker(b,c) :-
                                 <ul>
                                 <li> 
                                 evidence(-maker(b,c)).
                                 </li> 
                                 </ul> 
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     </ul> 
                 </li> 
                 <li> 
                 not accept_price_2_check :-
                     <ul>
                     <li> 
                     not accept_price_2(Var13 | {Var13 \= a,Var13 \= b},Var14 | {Var14 \= d},Var15),
                     </li> 
                     <li> 
                     not accept_price_2(Var13 | {Var13 \= a,Var13 \= b},d,Var16) :-
                         <ul>
                         <li> 
                         not maker(Var13 | {Var13 \= a,Var13 \= b},d) :-
                             <ul>
                             <li> 
                             not product(Var13 | {Var13 \= a,Var13 \= b}),
                             </li> 
                             <li> 
                             not product(Var13 | {Var13 \= a,Var13 \= b}).
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     not accept_price_2(a,Var17 | {Var17 \= d},Var18),
                     </li> 
                     <li> 
                     not accept_price_2(a,d,Var19) :-
                         <ul>
                         <li> 
                         not maker(a,d) :-
                             <ul>
                             <li> 
                             proved(product(a)),
                             </li> 
                             <li> 
                             not evidence(maker(a,d)),
                             </li> 
                             <li> 
                             proved(not evidence(maker(a,d))),
                             </li> 
                             <li> 
                             neg_maker(a,d) :-
                                 <ul>
                                 <li> 
                                 evidence(-maker(a,d)).
                                 </li> 
                                 </ul> 
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     not accept_price_2(b,Var20 | {Var20 \= d},Var21),
                     </li> 
                     <li> 
                     not accept_price_2(b,d,Var22 | {Var22 \= lowest}) :-
                         <ul>
                         <li> 
                         maker(b,d) :-
                             <ul>
                             <li> 
                             proved(product(b)),
                             </li> 
                             <li> 
                             evidence(maker(b,d)).
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     accept_price_2(b,d,lowest) :-
                         <ul>
                         <li> 
                         proved(maker(b,d)).
                         </li> 
                         </ul> 
                     </li> 
                     <li> 
                     not sale(b,d,lowest) :-
                         <ul>
                         <li> 
                         not offer_price_b(b,d,lowest) :-
                             <ul>
                             <li> 
                             not offer_price_1(b,d,lowest),
                             </li> 
                             <li> 
                             not offer_price_2(b,d,lowest),
                             </li> 
                             <li> 
                             not offer_price_3(b,d,lowest),
                             </li> 
                             <li> 
                             not offer_price_4(b,d,lowest),
                             </li> 
                             <li> 
                             offer_price_5(b,d,lowest) :-
                                 <ul>
                                 <li> 
                                 mail_list :-
                                     <ul>
                                     <li> 
                                     evidence(mail_list).
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 cash :-
                                     <ul>
                                     <li> 
                                     evidence(cash).
                                     </li> 
                                     </ul> 
                                 </li> 
                                 </ul> 
                             </li> 
                             <li> 
                             not offer_price_1_check :-
                                 <ul>
                                 <li> 
                                 not offer_price_1(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},Var25 | {Var25 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},high),
                                 </li> 
                                 <li> 
                                 not buy(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},high),
                                         </li> 
                                         <li> 
                                         not accept_price_2(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},high),
                                         </li> 
                                         <li> 
                                         not accept_price_3(Var23 | {Var23 \= a,Var23 \= b},Var24 | {Var24 \= c,Var24 \= d},high).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(Var23 | {Var23 \= a,Var23 \= b},c,Var26 | {Var26 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(Var23 | {Var23 \= a,Var23 \= b},c,high),
                                 </li> 
                                 <li> 
                                 not buy(Var23 | {Var23 \= a,Var23 \= b},c,high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(Var23 | {Var23 \= a,Var23 \= b},c,high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(Var23 | {Var23 \= a,Var23 \= b},c,high) :-
                                             <ul>
                                             <li> 
                                             not maker(Var23 | {Var23 \= a,Var23 \= b},c) :-
                                                 <ul>
                                                 <li> 
                                                 not product(Var23 | {Var23 \= a,Var23 \= b}),
                                                 </li> 
                                                 <li> 
                                                 not product(Var23 | {Var23 \= a,Var23 \= b}).
                                                 </li> 
                                                 </ul> 
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         not accept_price_2(Var23 | {Var23 \= a,Var23 \= b},c,high),
                                         </li> 
                                         <li> 
                                         not accept_price_3(Var23 | {Var23 \= a,Var23 \= b},c,high) :-
                                             <ul>
                                             <li> 
                                             not maker(Var23 | {Var23 \= a,Var23 \= b},c) :-
                                                 <ul>
                                                 <li> 
                                                 not product(Var23 | {Var23 \= a,Var23 \= b}),
                                                 </li> 
                                                 <li> 
                                                 not product(Var23 | {Var23 \= a,Var23 \= b}).
                                                 </li> 
                                                 </ul> 
                                             </li> 
                                             </ul> 
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(Var23 | {Var23 \= a,Var23 \= b},d,Var27 | {Var27 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(Var23 | {Var23 \= a,Var23 \= b},d,high),
                                 </li> 
                                 <li> 
                                 not buy(Var23 | {Var23 \= a,Var23 \= b},d,high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(Var23 | {Var23 \= a,Var23 \= b},d,high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(Var23 | {Var23 \= a,Var23 \= b},d,high),
                                         </li> 
                                         <li> 
                                         not accept_price_2(Var23 | {Var23 \= a,Var23 \= b},d,high) :-
                                             <ul>
                                             <li> 
                                             not maker(Var23 | {Var23 \= a,Var23 \= b},d) :-
                                                 <ul>
                                                 <li> 
                                                 not product(Var23 | {Var23 \= a,Var23 \= b}),
                                                 </li> 
                                                 <li> 
                                                 not product(Var23 | {Var23 \= a,Var23 \= b}).
                                                 </li> 
                                                 </ul> 
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         not accept_price_3(Var23 | {Var23 \= a,Var23 \= b},d,high).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(a,Var28 | {Var28 \= c,Var28 \= d},Var29 | {Var29 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(a,Var28 | {Var28 \= c,Var28 \= d},high),
                                 </li> 
                                 <li> 
                                 not buy(a,Var28 | {Var28 \= c,Var28 \= d},high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(a,Var28 | {Var28 \= c,Var28 \= d},high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(a,Var28 | {Var28 \= c,Var28 \= d},high),
                                         </li> 
                                         <li> 
                                         not accept_price_2(a,Var28 | {Var28 \= c,Var28 \= d},high),
                                         </li> 
                                         <li> 
                                         not accept_price_3(a,Var28 | {Var28 \= c,Var28 \= d},high).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(a,c,Var30 | {Var30 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(a,c,high),
                                 </li> 
                                 <li> 
                                 not buy(a,c,high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(a,c,high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(a,c,high) :-
                                             <ul>
                                             <li> 
                                             proved(maker(a,c)).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         not accept_price_2(a,c,high),
                                         </li> 
                                         <li> 
                                         not accept_price_3(a,c,high) :-
                                             <ul>
                                             <li> 
                                             proved(maker(a,c)).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(a,d,Var31 | {Var31 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(a,d,high),
                                 </li> 
                                 <li> 
                                 not buy(a,d,high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(a,d,high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(a,d,high),
                                         </li> 
                                         <li> 
                                         not accept_price_2(a,d,high) :-
                                             <ul>
                                             <li> 
                                             proved(not maker(a,d)).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         not accept_price_3(a,d,high).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(b,Var32 | {Var32 \= c,Var32 \= d},Var33 | {Var33 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(b,Var32 | {Var32 \= c,Var32 \= d},high),
                                 </li> 
                                 <li> 
                                 not buy(b,Var32 | {Var32 \= c,Var32 \= d},high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(b,Var32 | {Var32 \= c,Var32 \= d},high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(b,Var32 | {Var32 \= c,Var32 \= d},high),
                                         </li> 
                                         <li> 
                                         not accept_price_2(b,Var32 | {Var32 \= c,Var32 \= d},high),
                                         </li> 
                                         <li> 
                                         not accept_price_3(b,Var32 | {Var32 \= c,Var32 \= d},high).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(b,c,Var34 | {Var34 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(b,c,high),
                                 </li> 
                                 <li> 
                                 not buy(b,c,high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(b,c,high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(b,c,high) :-
                                             <ul>
                                             <li> 
                                             proved(not maker(b,c)).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         not accept_price_2(b,c,high),
                                         </li> 
                                         <li> 
                                         not accept_price_3(b,c,high) :-
                                             <ul>
                                             <li> 
                                             proved(not maker(b,c)).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 not offer_price_1(b,d,Var35 | {Var35 \= high}),
                                 </li> 
                                 <li> 
                                 offer_price_1(b,d,high),
                                 </li> 
                                 <li> 
                                 not buy(b,d,high) :-
                                     <ul>
                                     <li> 
                                     not accept_price(b,d,high) :-
                                         <ul>
                                         <li> 
                                         not accept_price_1(b,d,high),
                                         </li> 
                                         <li> 
                                         not accept_price_2(b,d,high) :-
                                             <ul>
                                             <li> 
                                             proved(maker(b,d)).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         not accept_price_3(b,d,high).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 </ul> 
                             </li> 
                             <li> 
                             offer_price_2_check :-
                                 <ul>
                                 <li> 
                                 offer_price_2(a,c,low) :-
                                     <ul>
                                     <li> 
                                     senior_customer :-
                                         <ul>
                                         <li> 
                                         age_older_than_65 :-
                                             <ul>
                                             <li> 
                                             evidence(age_older_than_65).
                                             </li> 
                                             </ul> 
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 <li> 
                                 buy(a,c,low) :-
                                     <ul>
                                     <li> 
                                     accept_price(a,c,low) :-
                                         <ul>
                                         <li> 
                                         accept_price_3(a,c,low) :-
                                             <ul>
                                             <li> 
                                             maker(a,c) :-
                                                 <ul>
                                                 <li> 
                                                 product(a) :-
                                                     <ul>
                                                     <li> 
                                                     proved(product_a).
                                                     </li> 
                                                     </ul> 
                                                 </li> 
                                                 <li> 
                                                 proved(evidence(maker(a,c))).
                                                 </li> 
                                                 </ul> 
                                             </li> 
                                             </ul> 
                                         </li> 
                                         <li> 
                                         proved(not accept_price_1_check),
                                         </li> 
                                         <li> 
                                         chs(not accept_price_2_check).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     <li> 
                                     quality(a) :-
                                         <ul>
                                         <li> 
                                         evidence(quality(a)).
                                         </li> 
                                         </ul> 
                                     </li> 
                                     </ul> 
                                 </li> 
                                 </ul> 
                             </li> 
                             </ul> 
                         </li> 
                         </ul> 
                     </li> 
                     </ul> 
                 </li> 
                 </ul> 
             </li> 
             <li> 
             proved(quality(a)).
             </li> 
             </ul> 
         </li> 
         <li> 
         sale(a,c,low) :-
             <ul>
             <li> 
             offer_price_a(a,c,low) :-
                 <ul>
                 <li> 
                 proved(offer_price_2(a,c,low)),
                 </li> 
                 <li> 
                 proved(not offer_price_1_check).
                 </li> 
                 </ul> 
             </li> 
             </ul> 
         </li> 
         </ul> 
     </li> 
     <li> 
     global_constraint.
     </li> 
 </ul> 

<script
  src="https://code.jquery.com/jquery-1.11.2.min.js"
  integrity="sha256-Ls0pXSlb7AYs7evhd+VLnWsZ/AqEHcXBeMZUycz/CcA="
  crossorigin="anonymous"></script>

<script type="text/javascript">
    (function($){
        $.fn.depth = function(options,depth) {
            options = options || {};
            options.delay = options.delay || 0;
            
            this.find("> li").each(function() {
                e = $(this)
                var subtree = e.find('> ul');

                if (subtree.length > 0) {
                    if (depth > 0) {
                        e.addClass('tree-opened');
                        e.removeClass('tree-closed');

                        //subtree.slideDown(options.delay);
                        subtree.show(options.delay);

                        subtree.depth(options,depth-1);
                    } else {
                        e.removeClass('tree-opened');
                        e.addClass('tree-closed');

                        //subtree.slideUp(options.delay);
                        subtree.hide(options.delay);

                        subtree.collapse(options);
                    }
                }
            });
            return true;
        }
        
        $.fn.expand = function(options,depth) {
            options = options || {};
            options.delay = options.delay || 0;
            
            this.find("> li").each(function() {
                e = $(this)
                var subtree = e.find('> ul');

                if (subtree.length > 0) {
                    e.addClass('tree-opened');
                    e.removeClass('tree-closed');

                    //subtree.slideDown(options.delay);
                    subtree.show(options.delay);

                    subtree.expand(options,depth+1);
                }
                //g_depth=Math.max(g_depth,depth);
            });
            return true;
        }

        $.fn.collapse = function(options) {
            options = options || {};
            options.delay = options.delay || 0;
            
            this.find("> li").each(function() {
                e = $(this)
                var subtree = e.find('> ul');

                if (subtree.length > 0) {
                    e.removeClass('tree-opened');
                    e.addClass('tree-closed');

                    subtree.slideUp(options.delay);
                    subtree.hide(options.delay);

                    subtree.collapse(options);
                } 
            });
            return true;
        }
        
        $.fn.treemenu = function(options) {
            options = options || {};
            options.delay = options.delay || 0;
            options.openActive = options.openActive || false;
            options.closeOther = options.closeOther || false;
            options.activeSelector = options.activeSelector || ".active";

            this.addClass("treemenu");

            if (!options.nonroot) {
                this.addClass("treemenu-root");
            }

            options.nonroot = true;

            this.find("> li").each(function() {
                e = $(this);
                var subtree = e.find('> ul');
                var button = e.find('.toggler').eq(0);

                if(button.length == 0) {
                    // create toggler
                    var button = $('<span>');
                    button.addClass('toggler');
                    e.prepend(button);
                }

                if(subtree.length > 0) {
                    subtree.hide();

                    e.addClass('tree-closed');

                    e.find(button).click(function() {
                        var li = $(this).parent('li');

                        if (options.closeOther && li.hasClass('tree-closed')) {
                            var siblings = li.parent('ul').find("li:not(.tree-empty)");
                            siblings.removeClass("tree-opened");
                            siblings.addClass("tree-closed");
                            siblings.removeClass(options.activeSelector);
                            siblings.find('> ul').slideUp(options.delay);
                        }

                        li.find('> ul').slideToggle(options.delay);
                        li.toggleClass('tree-opened');
                        li.toggleClass('tree-closed');
                        li.toggleClass(options.activeSelector);
                    });

                    $(this).find('> ul').treemenu(options);
                } else {
                    $(this).addClass('tree-empty');
                }
            });

            if (options.openActive) {
                var cls = this.attr("class");

                this.find(options.activeSelector).each(function(){
                    var el = $(this).parent();

                    while (el.attr("class") !== cls) {
                        el.find('> ul').show();
                        if(el.prop("tagName") === 'UL') {
                            el.show();
                        } else if (el.prop("tagName") === 'LI') {
                            el.removeClass('tree-closed');
                            el.addClass("tree-opened");
                            el.show();
                        }

                        el = el.parent();
                    }
                });
            }

            //this.expand({delay:0},0);
            //max_depth = g_depth;
            //this.collapse({delay:0});
            //g_depth = 0;

            return this;
        }
    })(jQuery);

var g_depth = 0;
var max_depth = 400

function depth(step){
    g_depth = g_depth + step;
    g_depth = g_depth < 0 ? 0 : g_depth;
    g_depth = g_depth > max_depth ? max_depth : g_depth;
    $(".tree").depth({delay:0},g_depth);
}

function expand(){
    g_depth = 0     
    $(".tree").expand({delay:0},0);
}

function collapse(){
    $(".tree").collapse({delay:0});
    g_depth = 0;    
}

$(function(){
    $(".tree").treemenu({delay:0}).openActive();
});

</script>



 <div style='min-height: 400px'></div>

</body>
</html>

